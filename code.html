<!DOCTYPE html>
<html lang="cz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="code.pageTitle">MediLingua Quiz</title>
    <link rel="stylesheet" href="styles.css">
    <script src="languageSwitcher.js" defer></script>
</head>
<body>
    <div class="navbar">
        <a href="index.html" data-i18n="navbar.home">Domov</a>
        <a href="about.html" data-i18n="navbar.about">O nás</a>
        <a href="quiz.html" data-i18n="navbar.quiz">Quiz</a>
        <a href="lexicon.html" data-i18n="navbar.lexicon">Lexikon</a>
        <a href="symptomata.html" data-i18n="navbar.symptomata">Symptomata</a>
        <select id="languageSwitcher">
            <option value="en">English</option>
            <option value="cz" selected>Čeština</option>
        </select>
    </div>

    <header>
        <h1 data-i18n="code.headerTitle">MediLingua Quiz</h1>
    </header>

    <div class="content">
        <h2 data-i18n="code.contentTitle">Zvolte si procvičované oblasti</h2>
        <p data-i18n="code.contentIntro">Vítejte v MediLingua Quizu! Vyberte deklinace, pády a témata, která chcete procvičovat.</p>

        <label data-i18n="code.labelDeclensions" for="declensions">Deklinační skupiny:</label>
        <select id="declensions"></select>

        <label data-i18n="code.labelCases" for="cases">Pády:</label>
        <select id="cases"></select>

        <label data-i18n="code.labelTopics" for="topics">Témata:</label>
        <select id="topics"></select>

        <button onclick="startQuiz()" data-i18n="code.startButton">Spustit Quiz!</button>
    </div>

    <div id="quizContainer" style="display:none;">
        <!-- Quiz content will be dynamically loaded here -->
    </div>

    <footer>
        <p data-i18n="footer">© Lukáš Marônek 2024. Všechna práva vyhrazena.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Language switching
            const languageSwitcher = document.getElementById('languageSwitcher');
            
            // Function to load translations
            function loadLanguage(lang) {
                fetch(`lang-${lang}.json`)
                    .then(response => response.json())
                    .then(data => {
                        document.querySelectorAll('[data-i18n]').forEach(element => {
                            const keys = element.getAttribute('data-i18n').split('.');
                            let translation = data;
                            keys.forEach(key => translation = translation[key]);
                            element.textContent = translation;
                        });
                    })
                    .catch(error => console.error('Error loading language:', error));
            }

            // Initial language load from localStorage or default to Czech
            const savedLang = localStorage.getItem('selectedLanguage') || 'cz';
            languageSwitcher.value = savedLang;
            loadLanguage(savedLang);

            // Change language and save user preference
            languageSwitcher.addEventListener('change', () => {
                const selectedLang = languageSwitcher.value;
                localStorage.setItem('selectedLanguage', selectedLang);
                loadLanguage(selectedLang);
            });

            // Load dynamic content for the quiz
            loadDeclensions();
            loadCases();
            loadTopics();
        });

        // Function to load Declensions dynamically
        function loadDeclensions() {
            const declensions = ['1st Declension', '2nd Declension', '3rd Declension']; // Example data
            const declensionsSelect = document.getElementById('declensions');
            declensions.forEach(declension => {
                const option = document.createElement('option');
                option.value = declension;
                option.textContent = declension;
                declensionsSelect.appendChild(option);
            });
        }

        // Function to load Cases dynamically
        function loadCases() {
            const cases = ['Nominative', 'Genitive', 'Dative', 'Accusative', 'Ablative']; // Example data
            const casesSelect = document.getElementById('cases');
            cases.forEach(c => {
                const option = document.createElement('option');
                option.value = c;
                option.textContent = c;
                casesSelect.appendChild(option);
            });
        }

        // Function to load Topics dynamically
        function loadTopics() {
            const topics = ['Systema skeletale', 'Systema musculare', 'Systema respiratorium']; // Example data
            const topicsSelect = document.getElementById('topics');
            topics.forEach(topic => {
                const option = document.createElement('option');
                option.value = topic;
                option.textContent = topic;
                topicsSelect.appendChild(option);
            });
        }

        // Function to start the quiz (this will need your existing logic for handling the quiz)
        function startQuiz() {
            const declension = document.getElementById('declensions').value;
            const caseType = document.getElementById('cases').value;
            const topic = document.getElementById('topics').value;
            console.log(`Starting quiz for ${declension}, ${caseType}, ${topic}`);
            
            // Load content from .txt based on the selected options
            fetchQuizData(declension, caseType, topic);
        }

        // Fetch quiz data from the theme1.txt based on selections
        function fetchQuizData(declension, caseType, topic) {
            const themeFile = `theme1.txt`; // Example for now, use relevant logic here based on your selection
            fetch(themeFile)
                .then(response => response.text())
                .then(data => {
                    console.log('Quiz data loaded:', data);
                    document.getElementById('quizContainer').style.display = 'block'; // Display quiz content
                    // Here, you can process and display the data
                })
                .catch(error => console.error('Error loading quiz data:', error));
        }
    </script>
</body>
</html>
